{% extends 'base.html' %}
{% load static humanize %}

{% block content %}
<section id="listing-detail-screen" class="screen-page">
    <div class="detail-container">
        <!-- Back Button logic would normally be history.back() or link to category -->
        <div class="modal-header">
            <h3>Listing Details</h3>
            <a href="javascript:history.back()" class="btn-icon"><i class="ph ph-arrow-left"></i></a>
        </div>
        
        {% if house.image %}
        <img src="{{ house.image.url }}" style="width:100%; height:250px; object-fit:cover; border-radius:12px; margin-bottom:16px;" alt="{{ house.title }}">
        {% else %}
        <div style="width:100%; height:250px; background:#f0f0f0; border-radius:12px; margin-bottom:16px; display:flex; align-items:center; justify-content:center; color:#aaa;">
            <i class="ph ph-image" style="font-size:3rem;"></i>
        </div>
        {% endif %}
        
        <div style="display:flex; justify-content:space-between; align-items:start; margin-bottom:8px; flex-direction: column; gap: 8px;">
            <h2 style="margin:0; color:var(--primary);">â‚¦{{ house.rent|intcomma }}/yr</h2>
            <div style="display:flex; gap:6px; flex-wrap:wrap;">
                {% if house.is_verified_listing %}
                <span class="badge badge-verified"><i class="ph-fill ph-seal-check"></i> Verified Listing</span>
                {% else %}
                <span class="badge" style="background:#FEF3C7; color:#B45309;">Unverified Listing</span>
                {% endif %}

                {% if house.posted_by.is_verified_student %}
                <span class="badge" style="background:#e0f2fe; color:#0284c7;"><i class="ph-fill ph-student"></i> Verified Student</span>
                {% else %}
                <span class="badge" style="background:#FEF3C7; color:#B45309;">Unverified User</span>
                {% endif %}
            </div>
        </div>
        
        <h3 style="margin-bottom:8px;">{{ house.title }}</h3>
        <p style="margin-bottom:16px;"><i class="ph ph-map-pin"></i> {{ house.location }}</p>
        
        <div style="background:#F8FAFC; padding:16px; border-radius:12px; margin-bottom:20px;">
            <h4 style="margin-bottom:8px;">Details</h4>
            <div class="tags">
                <span class="tag">{{ house.get_listing_type_display }}</span>
                <span class="tag">Posted by {{ house.posted_by.full_name }}</span>
                <span class="tag">{{ house.created_at|timesince }} ago</span>
            </div>
        </div>

        <div style="margin-bottom:20px;">
            <h4 style="margin-bottom:8px;">Description</h4>
            <p>{{ house.description|default:"No description provided."|linebreaks }}</p>
        </div>

        <div style="display:flex; gap:12px; margin-bottom: 80px;"> <!-- Margin bottom for sticky nav -->
            <a href="tel:{{ house.posted_by.phone_number }}" class="btn btn-secondary" style="flex:1;"><i class="ph ph-phone"></i> Call Agent</a>
            <a href="https://wa.me/{{ house.posted_by.whatsapp_link }}?text=Hi, I am interested in {{ house.title }}" target="_blank" class="btn btn-primary" style="flex:1; background-color:#25D366; border:none;"><i class="ph-fill ph-whatsapp-logo"></i> WhatsApp</a>
        </div>
    </div>
</section>
{% endblock %}